import{d as a,s as e,z as s,h as r,an as o,o as t,c as l,l as n,J as d,V as c,a as u,D as i,w as m,E as p,ao as g,x as w,y as _,ap as f,$ as h,ab as y,aq as v,ac as x}from"./vendor-178c6cbf.js";import{u as b,f as k,g as V,d as q,h as C,_ as L}from"./index-72685b17.js";const R=""+new URL("../png/logo-7c06d511.png",import.meta.url).href,U=a=>(w("data-v-55a90ee4"),a=a(),_(),a),E={class:"login-container"},F={class:"content-box"},j=U((()=>n("img",{class:"logo",src:R,alt:""},null,-1))),z=U((()=>n("p",{class:"header"},"Welcome to Flockmaster Blog",-1))),B={class:"form"},D={class:"form-list"},I={class:"bottom-button"},K=U((()=>n("p",null,m("游客")+"?",-1))),N=L(a({__name:"login",props:{redirect:{type:Boolean}},emits:["closeLogin"],setup(a,{emit:w}){const{user:_,circleFriend:L}=b(),{userInfo:R}=e(_),U=s(),N=w,O=a,T=r("login"),J=o({user_name:"",password:""}),S=r(),W=()=>{J.user_name="",J.password=""},$=()=>{O.redirect&&(U.currentRoute.value.query.from?U.push(String(U.currentRoute.value.query.from)):U.push("/home"))},A=async()=>{await(async()=>{const a={user_name:f(),password:"123456"};await k(a),J.password=a.password,J.user_name=a.user_name})(),await(async()=>{const{data:a}=await V(J);200===a.code&&(q.setCache("TOKEN",a.data.token),await H())})(),N("closeLogin"),$(),W(),p({message:"登录成功",type:"success"})},G=o({user_name:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:13,message:"账号应在3到13位",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"change"},{min:6,max:13,message:"密码应在6到13位",trigger:"blur"}]}),H=async()=>{const{data:a}=await C();200===a.code&&(R.value=a.data,q.setCache("user_info",a.data))};return(a,e)=>{const s=y,r=v,o=x,w=g;return t(),l("div",E,[n("div",F,[j,z,d(n("div",B,[u(w,{ref_key:"loginFormRef",ref:S,"label-width":"60px",rules:G,inline:"","hide-required-asterisk":"",model:J,style:{"max-width":"460px"}},{default:i((()=>[n("div",D,[u(r,{prop:"user_name"},{default:i((()=>[u(s,{modelValue:J.user_name,"onUpdate:modelValue":e[0]||(e[0]=a=>J.user_name=a)},null,8,["modelValue"])])),_:1}),u(r,{prop:"password"},{default:i((()=>[u(s,{modelValue:J.password,"onUpdate:modelValue":e[1]||(e[1]=a=>J.password=a),"show-password":"",type:"password"},null,8,["modelValue"])])),_:1}),u(r,null,{default:i((()=>[n("div",I,[u(o,{onClick:e[2]||(e[2]=a=>(async a=>{a&&await a.validate((async a=>{try{const{data:a}=await V(J);p({message:"登录成功",type:"success"}),H(),q.setCache("TOKEN",a.data.token),L.getUserDianzan(),N("closeLogin"),$(),W()}catch(e){p.error(e.message)}}))})(S.value))},{default:i((()=>[h("登录")])),_:1})])])),_:1})])])),_:1},8,["rules","model"])],512),[[c,"login"===T.value]]),n("div",{class:"create-account"},[K,n("p",{class:"create",onClick:A},m("点我快速登录"))])])])}}}),[["__scopeId","data-v-55a90ee4"]]);export{N as L};
